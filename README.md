# EventConditionPro
逻辑和运算增强插件

——***以创作者为本，让RM没有难做的演出***

<br/>

本插件支持通过插件指令进行各种复杂的逻辑和数值运算，适用于RMMZ和RMMV<br/>
本插件逻辑较为复杂，因此附带了示例工程，请结合本文的使用说明与示例工程来了解详细使用方法<br/>

<br/>

QQ群：***792888538***   欢迎反馈遇到的问题和希望支持的功能

<br/>

MZ/MV 视频教程：

<br/>
<br/>

## 需求背景：

1. RM的开关可以理解为一个bool变量，但是RM并没有内置支持逻辑运算与或非，因此大部分复杂逻辑的实现变得较为困难

<br/>

2. RM开关与变量之间并没有互相打通，诸如判断变量的值并将结果存入开关这种需求的实现也较为麻烦，独立开关更是完全无法参与逻辑

<br/>

3. RM变量自身的运算也不够完善，无法计算两个变量的运算并将结果存在第三个变量内，而必须存在两者之一。此外，也没有快速判断开关并给变量赋值的简单方法，取大取小这种基本逻辑也有缺失

<br/>

4. 事件出现条件太过简单，不能支持复杂的逻辑判断，不能支持或非，不能支持自定义条件的先后顺序(括号的功能)，不能支持多样的判断条件

<br/>

5. 独立开关数量太少

<br/>
<br/>

## 插件功能：

针对以上问题，本插件提供以下功能解决：

<br/>

1. 支持通过插件指令进行各种复杂的逻辑和数值运算
   * 通过变量指令进行数值运算，得到数值结果
   * 通过条件指令进行逻辑判断，得到bool结果，同时将操作对象的值存在指定的位置
   * 通过运算指令组合bool结果，得到复合结果
   * 得到的结果可用于事件出现条件和条件分歧，或者直接存回RM变量或开关或独立开关

<br/>

2. 支持自定义任意复杂的事件出现条件

<br/>

3. 支持自定义任意复杂的逻辑用于条件分歧

<br/>

4. 对于并行处理和公共事件，支持定义任意按键触发

<br/>

5. 支持 A-Z 26个独立开关

<br/>
<br/>

## 指令参数：

插件指令常用的参数类型，根据情况填写

<br/>

1. [开关]：开关类参数允许以下类型：
   * 单个字母A-Z：独立开关
   * 以字母s开头，后面接序号，如s31：RM开关
   * 临时变量名字，如temp：临时变量
   * 直接写true，或者false(不适用于存返回结果)

<br/>

2. [变量]：变量类参数允许以下类型：
   * 以字母v开头，后面接序号，如v31：RM变量
   * 临时变量名字，如temp：临时变量
   * 直接写数值(不适用于存返回结果)

<br/>

3. [序号]：序号类参数一定需要是正整数，对应相应序号

<br/>

4. [名字]：名字类参数一定需要是字符串，对应相应名字

<br/>
<br/>

## 插件指令：

常用的插件指令
   * MV需要采用这种格式：逻辑增强 指令类型 指令参数
   * 两用的指令，后缀为 _出现 的用于事件出现条件，后缀为 _事件 的用于事件页内

<br/>

1. 启用(出现)：让事件页使用自定义出现条件，要在事件页开头设置一个本指令并将参数设置为true<br/>
   设置了本指令的事件页会完全使用自定义条件忽略RM原生条件，关闭则反之<br/>
   设置好后，当前事件页所有带有 (用于出现条件) 的指令都会被纳入考量，不用时关闭本指令即可，无需大量删除
   * 启用：true/false
   * MV示例：逻辑增强 启用_出现 true

<br/>

2. 条件(两用)：通过条件列表设置一组[开关]，每一条的结果支持保存供后续取用
   * 结果：写[开关]，比较结果会保存在这里，留空为不保存
   * 取反：对当前条件的结果取反
   * 条件类型
   * 比较对象1的结果：临时变量，写[开关]或[变量]，比较对象1的值会保存在这里，留空为不保存
   * 比较对象1：开关、变量、物品、武器、防具、事件朝向/位置(玩家为-1，当前事件为0)、角色、按键用[序号]，临时变量、独立开关用[名字]，脚本直接写，金币和时间不用写
   * 比较类型：开关类只分为等于和其他两种，物品、武器、防具、金币、时间、事件朝向比较值，角色、按键、脚本不写
   * 比较对象2：开关类写[开关]，变量类和物品、武器、防具、金币、时间、事件位置写[变量]，按键写触发类型(被触发、被重复、其他都为被按下)，事件朝向写方向(下、左、右、上)、角色、脚本不写
   * 可以配置多条，按顺序执行
   * MV使用本指令需要在插件参数内使用 条件转换 生成json字符串
   * MV示例：逻辑增强 条件_出现 json
   * MV示例：逻辑增强 条件_事件 json

<br/>

3. 变量(两用)：通过变量列表设置一组[变量]，每一条的结果支持保存供后续取用
   * 结果：写[变量]，运算结果会保存在这里
   * 运算对象1取负数
   * 运算对象1：写[变量]，随机数是较小值，脚本直接写
   * 运算类型
   * 运算对象2取负数
   * 运算对象2：写[变量]，随机数是较大值，脚本不写
   * 条件：运算类型为条件时才需要填写，写[开关]，开关为true则返回运算对象1反之返回运算对象2
   * 可以配置多条，按顺序执行
   * MV使用本指令需要在插件参数内使用 变量转换 生成json字符串
   * MV示例：逻辑增强 变量_出现 json
   * MV示例：逻辑增强 变量_事件 json

<br/>

4. 运算(两用)：对一组[开关]进行逻辑组合，每一条的结果支持保存供后续取用
   * 结果：写[开关]，运算结果会保存在这里
   * 运算对象1取反
   * 运算对象1：写[开关]
   * 操作类型
   * 运算对象2取反
   * 运算对象2：写[开关]
   * 可以配置多条，按顺序执行
   * MV使用本指令需要在插件参数内使用 运算转换 生成json字符串
   * MV示例：逻辑增强 运算_出现 json
   * MV示例：逻辑增强 运算_事件 json

<br/>

5. 输出(两用)：将一个临时变量的值输出到控制台
   * 名称
   * MV示例：逻辑增强 输出_出现 临时变量名字
   * MV示例：逻辑增强 输出_事件 临时变量名字

<br/>

6. 提交(两用)：将一个临时变量作为事件页的出现条件的最终判定结果提交
   * 名称
   * MV示例：逻辑增强 提交_出现 临时变量名字
   * MV示例：逻辑增强 提交_事件 临时变量名字

<br/>

7. 清空临时变量(事件)：事件页内执行运算时，为保证临时变量不互相影响，可用本指令清除之前的变量
   * MV示例：逻辑增强 清空临时变量

<br/>

8. 独立开关(事件)：用本指令可以设置超过D的独立开关
   * 名称
   * 开启：true/false
   * MV示例：逻辑增强 独立开关 E true

<br/>

9. 按键(触发)：在并行处理的事件页内使用，可以自定义按键来触发事件
   * 按键：填写KeyCode，可通过百度得到，如R为82
   * MV示例：逻辑增强 按键 82

<br/>
<br/>

## 使用说明：

本说明需要结合示例工程，请打开工程对比本说明使用

<br/>

### 示例群1

地图左下角，本示例群演示插件指令内开关的写法和使用

![示例](https://github.com/cafel176/EventConditionPro/blob/main/ex1.png?raw=true '示例')

<br/>

最下方事件互动打开开关DDD，上方三个事件进行出现条件判断，顺序由上往下依次是：

<br/>

#### 事件1

1. 开启事件出现条件判断，开启后会判断插件条件并完全忽略RM条件，关闭反之

![示例](https://github.com/cafel176/EventConditionPro/blob/main/ex0.png?raw=true '示例')

<br/>

2. 临时变量temp1 = true，使用脚本script直接赋值temp1

![示例](https://github.com/cafel176/EventConditionPro/blob/main/ex2.png?raw=true '示例')

<br/>

3. 判断DDD是否等于temp1，使用临时开关类型，判断temp1是否等于开关4，并将结果保存在另一个临时变量temp内

![示例](https://github.com/cafel176/EventConditionPro/blob/main/ex3.png?raw=true '示例')

4. 将临时变量temp作为结果提交，temp的开关与否将决定本事件是否出现

![示例](https://github.com/cafel176/EventConditionPro/blob/main/ex4.png?raw=true '示例')

<br/>

#### 事件2


<br/>
<br/>

## MV使用插件参数生成插件指令所需的Json：
本说明仅用于MV，MZ用户直接使用插件指令即可

<br/>

条件、变量、运算三种插件指令需要Json字符串作为参数，因此需要在插件参数内配置好后拷贝其Json作为指令参数

![参数转换](https://github.com/cafel176/EventConditionPro/blob/main/pic1.png?raw=true '参数转换')

<br/>

1. 首先根据需求通过UI配置好对应的参数

![参数](https://github.com/cafel176/EventConditionPro/blob/main/pic2.png?raw=true '参数')

<br/>

2. 右键参数，选择“以文本编辑”

![参数](https://github.com/cafel176/EventConditionPro/blob/main/pic3.png?raw=true '参数')

<br/>

3. 在弹出的窗口内，全选文本并复制

![参数](https://github.com/cafel176/EventConditionPro/blob/main/pic4.png?raw=true '参数')

<br/>

4. 之后在插件指令内，填写好插件名，指令类型后，粘贴刚才复制的Json字符串即可

![参数](https://github.com/cafel176/EventConditionPro/blob/main/pic5.png?raw=true '参数')

<br/>

5. 想要修改已经写好的插件指令时，将写在里面的Json字符串复制，打开插件编辑器，右键对应的插件参数，选择“以文本编辑”，粘贴进去，即可再次通过UI调整Json

<br/>

更多详细案例请在示例工程内寻找